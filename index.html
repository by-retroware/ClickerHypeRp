<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8"/>
    <title>Arizona Hype ‚Äî Clicker</title>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg1: #4a001f;
            --bg2: #1a0010;
            --neon: #ff0077;
            --neon-soft: #ff99cc;
            --success: #77ff00;
            --warning: #ffcc00;
            --error: #ff3333;
        }

        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            font-family: 'Press Start 2P', cursive;
            background: radial-gradient(circle at top, var(--bg1), var(--bg2));
            color: var(--neon);
            text-align: center;
            min-height: 100vh;
            overflow-x: hidden;
            padding-bottom: 20px;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –∏–≥—Ä—ã */
        .game-modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #1a0010;
            border: 3px solid var(--neon);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 0 30px rgba(255, 0, 119, 0.4);
            z-index: 1002;
            min-width: 350px;
            max-width: 500px;
            color: var(--neon-soft);
        }

        .game-modal h3 {
            color: var(--neon);
            margin: 0 0 15px;
            text-align: center;
            font-size: 16px;
        }

        .game-input {
            width: 100%;
            padding: 10px;
            margin: 8px 0;
            border: 2px solid #660033;
            border-radius: 8px;
            background: #050003;
            color: var(--neon);
            font-family: 'Press Start 2P', cursive;
            font-size: 11px;
        }

        .game-btn {
            background: transparent;
            border: 2px solid var(--neon);
            color: var(--neon);
            padding: 10px 15px;
            margin: 8px 5px;
            border-radius: 8px;
            cursor: pointer;
            font-family: 'Press Start 2P', cursive;
            font-size: 11px;
            transition: all 0.2s ease;
        }

        .game-btn:hover {
            background: var(--neon);
            color: #111;
        }

        .game-btn.accept {
            border-color: var(--success);
            color: var(--success);
        }

        .game-btn.accept:hover {
            background: var(--success);
            color: #111;
        }

        .game-btn.reject {
            border-color: var(--error);
            color: var(--error);
        }

        .game-btn.reject:hover {
            background: var(--error);
            color: #111;
        }

        .timer {
            font-size: 24px;
            color: var(--warning);
            margin: 15px 0;
            text-shadow: 0 0 10px var(--warning);
        }

        .game-result {
            font-size: 18px;
            color: var(--success);
            margin: 15px 0;
            text-shadow: 0 0 8px var(--success);
        }

        .coin-flip {
            font-size: 40px;
            margin: 20px 0;
            animation: flip 2s infinite;
        }

        @keyframes flip {
            0%, 100% { transform: rotateY(0deg); }
            50% { transform: rotateY(180deg); }
        }

        .invitation-info {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--neon);
            border-radius: 8px;
            padding: 10px;
            margin: 10px 0;
            font-size: 11px;
        }

        /* –û—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π */
        header {
            padding: 18px 10px;
            font-size: 20px;
            text-shadow: 0 0 10px var(--neon);
        }

        .subtext {
            font-size: 11px;
            color: var(--neon-soft);
            margin-top: -8px;
        }

        .auth-icons {
            position: fixed;
            right: 16px;
            top: 8px;
            z-index: 900;
        }

        .auth-icons img {
            width: 36px;
            height: 36px;
            margin-left: 10px;
            cursor: pointer;
            filter: drop-shadow(0 0 6px var(--neon));
        }

        .stats {
            display: flex;
            gap: 16px;
            justify-content: center;
            flex-wrap: wrap;
            margin: 18px;
        }

        .stat {
            width: 150px;
            border: 2px solid var(--neon);
            border-radius: 12px;
            padding: 12px;
            background: rgba(0, 0, 0, 0.25);
        }

        .stat .title {
            font-size: 12px;
            color: var(--neon-soft);
        }

        .stat .value {
            font-size: 18px;
            margin-top: 8px;
        }

        .menu {
            margin: 12px;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 8px;
        }

        .menu button {
            background: transparent;
            border: 2px solid var(--neon);
            color: var(--neon);
            padding: 8px 12px;
            margin: 6px;
            border-radius: 8px;
            cursor: pointer;
            position: relative;
            transition: all 0.3s ease;
        }

        .menu button:hover {
            background: var(--neon);
            color: #111;
            transform: translateY(-2px);
        }

        .submenu {
            display: none;
            position: absolute;
            top: 44px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(10, 5, 8, 0.95);
            border: 2px solid var(--neon);
            padding: 8px;
            border-radius: 8px;
            gap: 8px;
            display: flex;
            white-space: nowrap;
        }

        .submenu a {
            display: inline-block;
            padding: 8px;
            border-radius: 6px;
            border: 1px solid #660033;
            text-decoration: none;
            color: var(--neon);
            font-size: 12px;
        }

        .submenu a:hover {
            background: var(--neon);
            color: #111;
        }

        .menu .help:hover .submenu {
            display: flex;
            animation: fadeIn .25s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-6px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .clicker-area {
            margin-top: 18px;
            position: relative;
        }

        .click-btn {
            font-size: 18px;
            background: #0b0008;
            border: 3px solid var(--neon);
            padding: 18px 32px;
            border-radius: 14px;
            color: var(--neon);
            cursor: pointer;
            transition: transform .12s, background .12s;
        }

        .click-btn:hover {
            transform: scale(1.06);
            background: var(--neon);
            color: #111;
        }

        .click-btn:active {
            transform: scale(0.95);
        }

        .click-btn:disabled {
            opacity: .45;
            cursor: not-allowed;
            transform: none;
        }

        .coin-animation {
            position: absolute;
            pointer-events: none;
            font-size: 24px;
            animation: floatUp 1.5s ease-out forwards;
            opacity: 0;
        }

        @keyframes floatUp {
            0% {
                transform: translateY(0);
                opacity: 1;
            }
            100% {
                transform: translateY(-60px);
                opacity: 0;
            }
        }

        .info-box {
            max-width: 720px;
            margin: 16px auto;
            background: rgba(0, 0, 0, 0.35);
            border: 2px solid var(--neon);
            padding: 14px;
            border-radius: 10px;
            text-align: left;
            color: var(--neon-soft);
            font-size: 12px;
        }

        .glow-link {
            font-size: 11px;
            text-decoration: none;
            padding: 2px 6px;
            border-radius: 6px;
            animation: glow 3s infinite alternate;
            display: inline-block;
        }

        @keyframes glow {
            0% {
                color: var(--neon);
                text-shadow: 0 0 6px rgba(255, 0, 119, 0.18);
            }
            33% {
                color: #77ff00;
                text-shadow: 0 0 6px rgba(119, 255, 0, 0.12);
            }
            66% {
                color: #00ccff;
                text-shadow: 0 0 6px rgba(0, 204, 255, 0.12);
            }
            100% {
                color: var(--neon);
                text-shadow: 0 0 6px rgba(255, 0, 119, 0.18);
            }
        }

        .log-box {
            max-width: 720px;
            margin: 12px auto;
            background: rgba(0, 0, 0, 0.35);
            border: 2px solid var(--neon);
            padding: 12px;
            border-radius: 10px;
            text-align: left;
            font-size: 12px;
            color: var(--neon-soft);
        }

        .log-entry {
            padding: 6px;
            border-bottom: 1px dashed rgba(255, 0, 119, 0.08);
        }

        .modal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.75);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .modal .box {
            width: 360px;
            background: #1a0010;
            border: 2px solid var(--neon);
            padding: 14px;
            border-radius: 10px;
            text-align: center;
            position: relative;
        }

        .modal h2 {
            font-size: 14px;
            margin: 6px 0 10px;
        }

        .modal input {
            width: 92%;
            padding: 8px;
            margin: 6px 0;
            border-radius: 6px;
            border: 1px solid #440022;
            background: #050003;
            color: var(--neon);
            font-size: 12px;
        }

        .password-row {
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .eye {
            position: absolute;
            right: 34px;
            cursor: pointer;
            font-size: 14px;
            color: var(--neon);
        }

        .modal .small {
            font-size: 11px;
            color: var(--neon-soft);
            margin-top: 8px;
            cursor: pointer;
        }

        .modal .recaptcha {
            margin-top: 8px;
            background: #080408;
            padding: 8px;
            border-radius: 6px;
            border: 1px solid #333;
            color: var(--neon-soft);
            font-size: 11px;
        }

        .shop {
            max-width: 720px;
            margin: 20px auto;
            display: none;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 16px;
        }

        .shop-item {
            background: rgba(0, 0, 0, 0.35);
            border: 2px solid var(--neon);
            border-radius: 10px;
            padding: 12px;
            text-align: center;
        }

        .shop-item h3 {
            font-size: 14px;
            margin: 0 0 10px;
            color: var(--neon);
        }

        .shop-item p {
            font-size: 11px;
            color: var(--neon-soft);
            margin: 8px 0;
        }

        .shop-item .cost {
            color: var(--success);
            margin: 8px 0;
        }

        .shop-item button {
            background: transparent;
            border: 1px solid var(--neon);
            color: var(--neon);
            padding: 6px 10px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 11px;
        }

        .shop-item button:hover {
            background: var(--neon);
            color: #111;
        }

        .shop-item button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .withdraw-box {
            max-width: 720px;
            margin: 20px auto;
            background: rgba(0, 0, 0, 0.35);
            border: 2px solid var(--neon);
            padding: 14px;
            border-radius: 10px;
            display: none;
        }

        .withdraw-box h2 {
            font-size: 16px;
            margin: 0 0 14px;
            color: var(--neon);
            text-align: center;
        }

        .withdraw-form {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .withdraw-form input {
            padding: 8px;
            border-radius: 6px;
            border: 1px solid #440022;
            background: #050003;
            color: var(--neon);
            font-size: 12px;
        }

        .withdraw-form button {
            background: var(--neon);
            border: none;
            color: #111;
            padding: 10px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
        }

        .withdraw-form button:hover {
            background: #ff3399;
        }

        .raindrop {
            position: fixed;
            width: 2px;
            height: 18px;
            background: var(--neon);
            top: -30px;
            left: 0;
            opacity: .45;
            animation: fall linear infinite;
        }

        @keyframes fall {
            to {
                transform: translateY(110vh);
            }
        }

        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            border: 2px solid var(--neon);
            padding: 12px 20px;
            border-radius: 8px;
            color: var(--neon);
            z-index: 1001;
            animation: slideIn .3s ease, fadeOut .5s ease 2.5s forwards;
        }

        @keyframes slideIn {
            from {
                top: -100px;
                opacity: 0;
            }
            to {
                top: 20px;
                opacity: 1;
            }
        }

        @keyframes fadeOut {
            from {
                opacity: 1;
            }
            to {
                opacity: 0;
            }
        }

        .modal .error {
            color: #ff3333;
            font-size: 11px;
            margin: 4px 0;
            display: none;
        }

        .modal .input-error {
            border-color: #ff3333 !important;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è */
        .profile-btn {
            position: fixed;
            right: 16px;
            top: 8px;
            z-index: 900;
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-family: 'Press Start 2P', cursive;
            font-size: 10px;
            font-weight: bold;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.7);
            transition: all 0.3s ease;
            text-shadow: 0 0 5px rgba(0, 0, 0, 0.5);
            display: none;
        }

        .profile-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 0 15px rgba(102, 126, 234, 0.9);
        }

        .profile-modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #1a0010;
            border: 2px solid var(--neon);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 0 20px rgba(255, 0, 119, 0.3);
            z-index: 1000;
            min-width: 280px;
            color: var(--neon-soft);
            font-size: 12px;
        }

        .profile-info {
            margin: 10px 0;
            line-height: 1.6;
            padding: 5px;
            border-bottom: 1px dashed rgba(255, 0, 119, 0.2);
        }

        .overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 999;
        }

        /* –ü—Ä–æ–≥—Ä–µ—Å—Å –±–∞—Ä —É—Ä–æ–≤–Ω—è */
        .level-progress {
            width: 100%;
            height: 12px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 6px;
            margin: 8px 0;
            overflow: hidden;
            border: 1px solid var(--neon);
        }

        .level-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--neon), #ff3399);
            transition: width 0.5s ease;
        }

        /* –°—Ç–∏–ª—å –¥–ª—è –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —Å—É–º–º—ã –≤—ã–≤–æ–¥–∞ */
        .min-withdraw {
            font-size: 11px;
            color: var(--warning);
            margin: 5px 0;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–æ–¥—Å–∫–∞–∑–∫–∏ */
        .click-tooltip {
            position: fixed;
            background: rgba(255, 0, 0, 0.9);
            color: white;
            padding: 8px 12px;
            border: 2px solid #ff0000;
            border-radius: 6px;
            font-size: 12px;
            pointer-events: none;
            z-index: 10000;
            white-space: nowrap;
            box-shadow: 0 0 10px rgba(255, 0, 0, 0.5);
            display: none;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫—Ä–µ—Å—Ç–∏–∫–æ–≤ –∑–∞–∫—Ä—ã—Ç–∏—è */
        .close-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            background: transparent;
            border: none;
            color: var(--neon);
            font-size: 18px;
            cursor: pointer;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.2s ease;
        }

        .close-btn:hover {
            background: var(--neon);
            color: #111;
            transform: scale(1.1);
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø–æ–º–æ—â–∏ */
        .help-modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #1a0010;
            border: 2px solid var(--neon);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 0 20px rgba(255, 0, 119, 0.3);
            z-index: 1000;
            min-width: 300px;
            color: var(--neon-soft);
            font-size: 12px;
        }

        .help-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 15px;
        }

        .help-item {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--neon);
            border-radius: 8px;
            padding: 10px;
            text-align: center;
            transition: all 0.2s ease;
        }

        .help-item:hover {
            background: rgba(255, 0, 119, 0.1);
            transform: translateY(-2px);
        }

        .help-item a {
            color: var(--neon);
            text-decoration: none;
            display: block;
            padding: 5px;
        }

        .help-item a:hover {
            color: #fff;
        }

        /* –°—Ç–∏–ª—å –¥–ª—è –∫–Ω–æ–ø–∫–∏ Admin Panel */
        .admin-panel-btn {
            background: linear-gradient(45deg, #ff6b6b, #c0392b);
            border: 2px solid #fff;
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-family: 'Press Start 2P', cursive;
            font-size: 12px;
            transition: all 0.3s ease;
            box-shadow: 0 0 15px rgba(255, 107, 107, 0.5);
            width: 100%;
        }

        .admin-panel-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 0 20px rgba(255, 107, 107, 0.7);
            background: linear-gradient(45deg, #ff5252, #b83232);
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è —Ç–æ–ø–∞ –∏–≥—Ä–æ–∫–æ–≤ */
        .top-box {
            max-width: 720px;
            margin: 20px auto;
            background: rgba(0, 0, 0, 0.35);
            border: 2px solid var(--neon);
            padding: 14px;
            border-radius: 10px;
            display: none;
        }

        .top-box h2 {
            font-size: 16px;
            margin: 0 0 14px;
            color: var(--neon);
            text-align: center;
        }

        .top-list {
            text-align: left;
            margin-bottom: 15px;
        }

        .top-item {
            display: flex;
            justify-content: space-between;
            padding: 8px;
            border-bottom: 1px dashed rgba(255, 0, 119, 0.2);
        }

        .top-item:last-child {
            border-bottom: none;
        }

        .top-position {
            font-weight: bold;
            color: var(--neon);
            margin-right: 10px;
        }

        .top-info {
            flex-grow: 1;
        }

        .top-virts {
            color: var(--success);
            font-weight: bold;
        }

        .top-note {
            font-size: 10px;
            color: var(--neon-soft);
            text-align: center;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px dashed rgba(255, 0, 119, 0.2);
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–∞–ø—á–∏ */
        .captcha-modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #1a0010;
            border: 3px solid var(--neon);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 0 30px rgba(255, 0, 119, 0.4);
            z-index: 1003;
            min-width: 300px;
            color: var(--neon-soft);
            text-align: center;
        }

        .captcha-code {
            font-size: 24px;
            letter-spacing: 5px;
            background: rgba(255, 0, 119, 0.1);
            padding: 10px;
            margin: 15px 0;
            border-radius: 5px;
            color: var(--neon);
            font-weight: bold;
        }

        .captcha-input {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 2px solid #660033;
            border-radius: 8px;
            background: #050003;
            color: var(--neon);
            font-family: 'Press Start 2P', cursive;
            font-size: 14px;
            text-align: center;
        }

        /* –ö–Ω–æ–ø–∫–∞ –≤—ã—Ö–æ–¥–∞ –≤ –ø—Ä–æ—Ñ–∏–ª–µ */
        .logout-btn {
            background: transparent;
            border: 2px solid var(--error);
            color: var(--error);
            padding: 10px;
            border-radius: 6px;
            cursor: pointer;
            font-family: 'Press Start 2P', cursive;
            font-size: 11px;
            margin-top: 15px;
            width: 100%;
            transition: all 0.2s ease;
        }

        .logout-btn:hover {
            background: var(--error);
            color: #111;
        }

        .profile-divider {
            height: 1px;
            background: rgba(255, 0, 119, 0.3);
            margin: 15px 0;
        }

        /* –ß–∞—Å—ã –≤–Ω–∏–∑—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã */
        #clock {
            font-size: 16px;
            text-align: center;
            margin-top: 20px;
            margin-bottom: 10px;
            font-family: 'Press Start 2P', sans-serif;
            width: 100%;
            z-index: 1000;
            pointer-events: none;
            color: rgb(255, 255, 255);
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.8), 0 0 10px rgba(255, 255, 255, 0.6), 0 0 15px rgba(255, 255, 255, 0.4);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            position: relative;
        }
    </style>
</head>
<body>
<header>üíé Arizona Hype üíé</header>
<div class="subtext">by.retroware</div>

<!-- –ö–Ω–æ–ø–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è -->
<button class="profile-btn" onclick="showProfile()">üë§ –ü—Ä–æ—Ñ–∏–ª—å</button>

<div class="auth-icons">
    <img title="–í—Ö–æ–¥" src="https://cdn-icons-png.flaticon.com/512/1828/1828395.png" onclick="openLogin()" id="loginIcon"/>
</div>

<div class="stats">
    <div class="stat">
        <div class="title">–ú–æ–Ω–µ—Ç—ã</div>
        <div id="coins" class="value">0</div>
    </div>
    <div class="stat">
        <div class="title">–í–∏—Ä—Ç—ã</div>
        <div id="virts" class="value">0</div>
        <div class="title" style="font-size: 10px; margin-top: 5px;"></div>
    </div>
    <div class="stat">
        <div class="title">–°–∏–ª–∞ –∫–ª–∏–∫–∞</div>
        <div id="power" class="value">1</div>
    </div>
    <div class="stat">
        <div class="title">–í—Å–µ–≥–æ –∫–ª–∏–∫–æ–≤</div>
        <div id="totalClicks" class="value">0</div>
    </div>
</div>

<div class="menu">
    <button onclick="openMiniGames()">üéÆ –ú–∏–Ω–∏-–∏–≥—Ä—ã</button>
    <button onclick="toggleLog()">üìä –°–µ—Å—Å–∏–∏</button>
    <button onclick="toggleShop()">üõí –ú–∞–≥–∞–∑–∏–Ω</button>
    <button onclick="toggleWithdraw()">üí∏ –í—ã–≤–æ–¥</button>
    <button onclick="toggleTop()">üèÜ –¢–æ–ø</button>
    <button onclick="toggleHelp()">üìå –ü–æ–º–æ—â—å</button>
    <button onclick="toggleInfo()">üîé –ß—Ç–æ —ç—Ç–æ?</button>
</div>

<div class="clicker-area">
    <p style="color:var(--neon-soft);font-size:13px;margin-bottom:8px">–ö–ª–∏–∫–∞–π, —á—Ç–æ–±—ã –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –º–æ–Ω–µ—Ç—ã!</p>
    <button id="clickBtn" class="click-btn" onclick="clickCoin()" disabled>üëÜ –ö–ª–∏–∫–Ω–∏!</button>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –º–∏–Ω–∏-–∏–≥—Ä -->
<div class="game-modal" id="miniGamesModal">
    <h3>üéÆ –ú–∏–Ω–∏-–∏–≥—Ä—ã</h3>
    <div style="display: grid; gap: 10px; margin: 15px 0;">
        <button class="game-btn" onclick="openCoinGame()">ü™ô –û—Ä—ë–ª –∏ –†–µ—à–∫–∞</button>
        <button class="game-btn" onclick="showNotification('–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ', 'info')">üé≤ –ö–æ—Å—Ç–∏ (—Å–∫–æ—Ä–æ)</button>
        <button class="game-btn" onclick="showNotification('–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ', 'info')">üé∞ –°–ª–æ—Ç—ã (—Å–∫–æ—Ä–æ)</button>
    </div>
    <button class="close-btn" onclick="closeMiniGames()">√ó</button>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏–≥—Ä—ã –û—Ä—ë–ª –∏ –†–µ—à–∫–∞ -->
<div class="game-modal" id="coinGameModal">
    <h3>ü™ô –û—Ä—ë–ª –∏ –†–µ—à–∫–∞</h3>
    <p style="font-size: 11px; margin: 10px 0; color: var(--warning)">
        –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–∞–≤–∫–∞: 1.000.000 –≤–∏—Ä—Ç–æ–≤<br>
        –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å: 30
    </p>
    
    <input type="text" id="opponentVk" class="game-input" placeholder="–°—Å—ã–ª–∫–∞ VK —Å–æ–ø–µ—Ä–Ω–∏–∫–∞">
    <input type="number" id="betAmount" class="game-input" placeholder="–°—É–º–º–∞ —Å—Ç–∞–≤–∫–∏ (–æ—Ç 1000000)" min="1000000">
    
    <button class="game-btn" onclick="sendCoinInvite()">üéØ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ!</button>
    <button class="close-btn" onclick="closeCoinGame()">√ó</button>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è –≤ –∏–≥—Ä—É -->
<div class="game-modal" id="inviteModal">
    <h3>üéØ –ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –≤ –∏–≥—Ä—É</h3>
    <div class="invitation-info" id="inviteInfo">
        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–∏ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
    </div>
    <div class="timer" id="inviteTimer">45</div>
    <div>
        <button class="game-btn accept" onclick="acceptInvite()">‚úÖ –ü—Ä–∏–Ω—è—Ç—å</button>
        <button class="game-btn reject" onclick="rejectInvite()">‚ùå –û—Ç–∫–ª–æ–Ω–∏—Ç—å</button>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∏–≥—Ä—ã -->
<div class="game-modal" id="resultModal">
    <h3>üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç –∏–≥—Ä—ã</h3>
    <div class="coin-flip" id="coinResult">ü™ô</div>
    <div class="game-result" id="gameResult">
        <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç –∏–≥—Ä—ã –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
    </div>
    <button class="game-btn" onclick="closeResult()">OK</button>
</div>

<!-- –û—Å—Ç–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ -->
<div class="shop" id="shop">
    <div class="shop-item">
        <h3>–£–ª—É—á—à–µ–Ω–∏–µ –∫–ª–∏–∫–∞ +1</h3>
        <p>–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–æ–Ω–µ—Ç –∑–∞ –∫–ª–∏–∫</p>
        <div class="cost">–°—Ç–æ–∏–º–æ—Å—Ç—å: <span id="upgrade1Cost">10000</span> –º–æ–Ω–µ—Ç</div>
        <button onclick="buyUpgrade('click',getUpgradeCost(1),1)">–ö—É–ø–∏—Ç—å</button>
    </div>
    <div class="shop-item">
        <h3>–£–ª—É—á—à–µ–Ω–∏–µ –∫–ª–∏–∫–∞ +5</h3>
        <p>–ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –¥–æ—Ö–æ–¥ –∑–∞ –∫–ª–∏–∫</p>
        <div class="cost">–°—Ç–æ–∏–º–æ—Å—Ç—å: <span id="upgrade2Cost">45000</span> –º–æ–Ω–µ—Ç</div>
        <button onclick="buyUpgrade('click',getUpgradeCost(2),5)">–ö—É–ø–∏—Ç—å</button>
    </div>
    <div class="shop-item">
        <h3>–ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä</h3>
        <p>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–ª–∏–∫–∞–µ—Ç –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥</p>
        <div class="cost">–°—Ç–æ–∏–º–æ—Å—Ç—å: <span id="upgrade3Cost">250000</span> –º–æ–Ω–µ—Ç</div>
        <button onclick="buyUpgrade('autoclick',getUpgradeCost(3),1)">–ö—É–ø–∏—Ç—å</button>
    </div>
    <button class="close-btn" onclick="toggleShop()">√ó</button>
</div>

<div class="withdraw-box" id="withdrawBox">
    <h2>–í—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤</h2>
    <div class="withdraw-form">
        <input type="text" id="nickname" placeholder="–í–∞—à –∏–≥—Ä–æ–≤–æ–π –Ω–∏–∫–Ω–µ–π–º">
        <input type="number" id="withdrawAmount" placeholder="–°—É–º–º–∞ –¥–ª—è –≤—ã–≤–æ–¥–∞ (–º–∏–Ω. 3000 –≤–∏—Ä—Ç–æ–≤)" min="3000">
        <button onclick="requestWithdraw()">–ó–∞–ø—Ä–æ—Å–∏—Ç—å –≤—ã–≤–æ–¥</button>
    </div>
    <p class="min-withdraw">–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –¥–ª—è –≤—ã–≤–æ–¥–∞: 3000 –≤–∏—Ä—Ç–æ–≤</p>
    <p style="font-size:11px;margin-top:12px">–í—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –≤ —Ç–µ—á–µ–Ω–∏–µ 24 —á–∞—Å–æ–≤</p>
    <button class="close-btn" onclick="toggleWithdraw()">√ó</button>
</div>

<div class="top-box" id="topBox">
    <h2>üèÜ –¢–æ–ø –∏–≥—Ä–æ–∫–æ–≤ –∑–∞ –Ω–µ–¥–µ–ª—é</h2>
    <div class="top-list" id="topList">
        <!-- –¢–æ–ø –∏–≥—Ä–æ–∫–æ–≤ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
    </div>
    <div class="top-note">
        –ö–∞–∂–¥—É—é –Ω–µ–¥–µ–ª—é —Ç–æ–ø –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
    </div>
    <button class="close-btn" onclick="toggleTop()">√ó</button>
</div>

<div class="info-box" id="infoBox" style="display:none">
    <div style="font-family: 'Press Start 2P', sans-serif; font-size: 14px; line-height: 1.5; color: #ffffff; max-width: 600px;">
        –≠—Ç–æ –∫–ª–∏–∫–µ—Ä ‚Äî –ø—Ä–∏ –ø–æ–º–æ—â–∏ –∫–ª–∏–∫–µ—Ä–∞ –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞—Ä–∞–±–æ—Ç–∞—Ç—å –¥–µ–Ω—å–≥–∏ –Ω–∞ –Ω–∞—à–µ–º —Å–µ—Ä–≤–µ—Ä–µ <span id="serverName">Arizona RP Hype</span>.<br><br>
        –ú–æ–Ω–µ—Ç—ã –º–æ–∂–Ω–æ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ –≤–∏—Ä—Ç—ã —á–µ—Ä–µ–∑ –≤—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤.<br><br>
        –î–ª—è –≤—ã–≤–æ–¥–∞ –¥–µ–Ω–µ–≥ –∏–∑ –∏–≥—Ä—ã –≤–∞–º –Ω—É–∂–Ω–æ –Ω–∞–∂–∞—Ç—å –Ω–∞ –∫–Ω–æ–ø–∫—É <a id="withdraw" href="https://vk.com/arizonarphype" target="_blank" style="text-decoration: none;">–í—ã–≤–æ–¥,</a> –ø–æ—Å–ª–µ —á–µ–≥–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–≤–æ–π –∏–≥—Ä–æ–≤–æ–π Nick Name –∏ —Å—É–º–º—É –æ—Ç 3000 –≤–∏—Ä—Ç–æ–≤.<br><br>
        –í —Ç–µ—á–µ–Ω–∏–µ 24 —á–∞—Å–æ–≤ –¥–µ–Ω—å–≥–∏ –±—É–¥—É—Ç –ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ã –Ω–∞ –≤–∞—à –∏–≥—Ä–æ–≤–æ–π –∞–∫–∫–∞—É–Ω—Ç.
    </div>
    <button class="close-btn" onclick="toggleInfo()">√ó</button>
</div>

<div class="log-box" id="logBox" style="display:none">
    <button class="close-btn" onclick="toggleLog()">√ó</button>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–æ—Ñ–∏–ª—è -->
<div class="overlay" id="profileOverlay" onclick="hideProfile()"></div>
<div class="profile-modal" id="profileModal">
    <h3 style="color:var(--neon);margin:0 0 15px;text-align:center">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è</h3>
    <div class="profile-info"><strong>üë§ –ù–∏–∫–Ω–µ–π–º:</strong> <span id="profileUsername">–ì–æ—Å—Ç—å</span></div>
    <div class="profile-info"><strong>‚≠ê –£—Ä–æ–≤–µ–Ω—å –∏–≥—Ä–æ–∫–∞:</strong> <span id="profileLevel">1</span> (<span id="levelProgress">0%</span>)</div>
    <div class="level-progress">
        <div class="level-progress-bar" id="levelProgressBar" style="width: 0%"></div>
    </div>
    <div class="profile-info"><strong>üéØ –í—ã–≤–æ–¥–æ–≤ –≤–∏—Ä—Ç–æ–≤:</strong> <span id="profileWithdraws">0</span> —Ä–∞–∑</div>
    <div class="profile-info"><strong>üìÖ –ê–∫–∫–∞—É–Ω—Ç —Å–æ–∑–¥–∞–Ω:</strong> <span id="profileCreated">–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ</span></div>
    
    <!-- –ö–Ω–æ–ø–∫–∞ Admin Panel (–±—É–¥–µ—Ç –≤–∏–¥–Ω–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–≤–æ–µ–≥–æ VK) -->
    <div id="adminPanelBtn" style="display: none; margin-top: 20px; padding: 10px; border-top: 1px dashed var(--neon-soft);">
        <button class="admin-panel-btn" onclick="openAdminPanel()">
            ‚öôÔ∏è Admin Panel
        </button>
    </div>
    
    <div class="profile-divider"></div>
    
    <!-- –ö–Ω–æ–ø–∫–∞ –≤—ã—Ö–æ–¥–∞ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞ -->
    <button class="logout-btn" onclick="logout()">üö™ –í—ã–π—Ç–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞</button>
    
    <button class="close-btn" onclick="hideProfile()">√ó</button>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–º–æ—â–∏ -->
<div class="overlay" id="helpOverlay" onclick="toggleHelp()"></div>
<div class="help-modal" id="helpModal">
    <h3 style="color:var(--neon);margin:0 0 15px;text-align:center">üõü –ü–æ–º–æ—â—å</h3>
    <div class="help-grid">
        <div class="help-item">
            <a href="https://vk.com/diego_retroware" target="_blank">üõ†Ô∏è –¢–µ—Ö. —Ä–∞–∑–¥–µ–ª</a>
        </div>
        <div class="help-item">
            <a href="https://vk.com/mkaplin2016" target="_blank">üëë –í–ª–∞–¥–µ–ª–µ—Ü</a>
        </div>
        <div class="help-item">
            <a href="https://vk.com/id241326393" target="_blank">üíº –ü–æ–º–æ—â–Ω–∏–∫</a>
        </div>
    </div>
    <button class="close-btn" onclick="toggleHelp()">√ó</button>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∫–∞–ø—á–∏ -->
<div class="captcha-modal" id="captchaModal">
    <h3>üîí –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ, —á—Ç–æ –≤—ã –Ω–µ —Ä–æ–±–æ—Ç</h3>
    <p>–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –Ω–∏–∂–µ –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è:</p>
    <div class="captcha-code" id="captchaText">ABCD</div>
    <input type="text" class="captcha-input" id="captchaInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥" maxlength="6">
    <div style="display: flex; gap: 10px; justify-content: center; margin-top: 15px;">
        <button class="game-btn" onclick="validateCaptcha()">‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
        <button class="game-btn reject" onclick="closeCaptcha()">‚ùå –û—Ç–º–µ–Ω–∞</button>
    </div>
</div>

<div class="modal" id="loginModal" style="display:none">
    <div class="box">
        <button class="close-btn" onclick="closeModals()">√ó</button>
        <h2>–í—Ö–æ–¥</h2>
        <input id="loginVk" placeholder="VK ID (—Ü–∏—Ñ—Ä—ã –∏–ª–∏ —Å—Å—ã–ª–∫–∞)"/>
        <div class="error" id="loginVkError">–ù–µ–≤–µ—Ä–Ω—ã–π VK ID</div>
        <div class="password-row">
            <input id="loginPass" type="password" placeholder="–ü–∞—Ä–æ–ª—å"/>
            <span class="eye" onclick="togglePassword('loginPass')">üëÅ</span>
        </div>
        <div class="error" id="loginPassError">–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å</div>
        <div style="text-align:left;margin:6px 6%">
            <label style="font-size:11px;color:var(--neon-soft)"><input id="rememberMe" type="checkbox"/> –ó–∞–ø–æ–º–Ω–∏—Ç—å –º–µ–Ω—è</label>
        </div>
        <button onclick="doLogin()">–ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è</button>
        <div class="small" onclick="openRegister()">–ù–µ—Ç—É –∞–∫–∫–∞—É–Ω—Ç–∞? –°–æ–∑–¥–∞—Ç—å</div>
    </div>
</div>

<div class="modal" id="registerModal" style="display:none">
    <div class="box">
        <button class="close-btn" onclick="closeModals()">√ó</button>
        <h2>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
        <input id="regName" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"/>
        <div class="error" id="regNameError">–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</div>
        <input id="regVk" placeholder="VK ID (—Ü–∏—Ñ—Ä—ã –∏–ª–∏ —Å—Å—ã–ª–∫–∞)"/>
        <div class="error" id="regVkError">–ù–µ–≤–µ—Ä–Ω—ã–π VK ID</div>
        <div class="password-row">
            <input id="regPass" type="password" placeholder="–ü–∞—Ä–æ–ª—å"/>
            <span class="eye" onclick="togglePassword('regPass')">üëÅ</span>
        </div>
        <div class="error" id="regPassError">–ü–∞—Ä–æ–ª—å —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π (–º–∏–Ω. 4 —Å–∏–º–≤–æ–ª–∞)</div>
        <div class="password-row">
            <input id="regConfirm" type="password" placeholder="–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å"/>
            <span class="eye" onclick="togglePassword('regConfirm')">üëÅ</span>
        </div>
        <div class="error" id="regConfirmError">–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç</div>
        <div class="recaptcha">[ reCAPTCHA (–∑–∞–≥–ª—É—à–∫–∞) ]</div>
        <button onclick="doRegister()">–°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç –∏ –≤–æ–π—Ç–∏</button>
    </div>
</div>

<!-- –ü–æ–¥—Å–∫–∞–∑–∫–∞ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –∫–ª–∏–∫–∞ -->
<div id="clickTooltip" class="click-tooltip">–í–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç!</div>

<div id="clock"></div>

<script>
    const usersKey = "hype_users_v6", rememberKey = "hype_remembered_v6", topKey = "hype_top_players";
    let users = JSON.parse(localStorage.getItem(usersKey)) || {}, currentUser = null, sessionStarted = null, sessionClicks = 0, sessionTimer = null, clicksThisMinute = 0, cpmInterval = null, autoClickInterval = null;
    let clickTimes = []; // –î–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏ –∫–ª–∏–∫–æ–≤
    let captchaRequired = false;
    
    // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –∏–≥—Ä—ã
    let activeInvites = {}, currentInvite = null, gameTimers = {};

    const clickBtn = document.getElementById("clickBtn"),
        coinsEl = document.getElementById("coins"),
        virtsEl = document.getElementById("virts"),
        powerEl = document.getElementById("power"),
        totalClicksEl = document.getElementById("totalClicks"),
        logBox = document.getElementById("logBox"),
        infoBox = document.getElementById("infoBox"),
        shopEl = document.getElementById("shop"),
        withdrawBoxEl = document.getElementById("withdrawBox"),
        topBoxEl = document.getElementById("topBox"),
        topListEl = document.getElementById("topList"),
        loginIcon = document.getElementById("loginIcon"),
        profileBtn = document.querySelector(".profile-btn");

    const BASE_UPGRADE_COSTS = {
        1: 3000,
        2: 20000,
        3: 100000
    };

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–æ–ø–∞ –∏–≥—Ä–æ–∫–æ–≤
    function initTopPlayers() {
        if (!localStorage.getItem(topKey)) {
            const defaultTop = [
                {username: "Retroware", virts: 150000, vk: "diego_retroware"},
                {username: "Player2", virts: 75000, vk: "player2"},
                {username: "Player3", virts: 50000, vk: "player3"},
                {username: "Player4", virts: 25000, vk: "player4"},
                {username: "Player5", virts: 10000, vk: "player5"}
            ];
            localStorage.setItem(topKey, JSON.stringify(defaultTop));
        }
        updateTopList();
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Ç–æ–ø–∞
    function updateTopList() {
        const topPlayers = JSON.parse(localStorage.getItem(topKey)) || [];
        topListEl.innerHTML = '';
        
        topPlayers.forEach((player, index) => {
            const positionClass = index === 0 ? 'üèÜ' : index === 1 ? 'ü•à' : index === 2 ? 'ü•â' : `${index + 1}.`;
            
            const topItem = document.createElement('div');
            topItem.className = 'top-item';
            topItem.innerHTML = `
                <div class="top-position">${positionClass}</div>
                <div class="top-info">${player.username}</div>
                <div class="top-virts">${player.virts.toLocaleString()} –≤–∏—Ä—Ç–æ–≤</div>
            `;
            topListEl.appendChild(topItem);
        });
    }

    // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –º–∏–Ω–∏-–∏–≥—Ä
    function openMiniGames() {
        if (!currentUser) {
            showNotification("–í–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç —á—Ç–æ–±—ã –∏–≥—Ä–∞—Ç—å", "warning");
            return;
        }
        document.getElementById("miniGamesModal").style.display = "block";
        document.getElementById("profileOverlay").style.display = "block";
    }

    function closeMiniGames() {
        document.getElementById("miniGamesModal").style.display = "none";
        document.getElementById("profileOverlay").style.display = "none";
    }

    function openCoinGame() {
        document.getElementById("miniGamesModal").style.display = "none";
        document.getElementById("coinGameModal").style.display = "block";
    }

    function closeCoinGame() {
        document.getElementById("coinGameModal").style.display = "none";
        document.getElementById("profileOverlay").style.display = "none";
    }

    function sendCoinInvite() {
        if (!currentUser) {
            showNotification("–í–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç", "warning");
            return;
        }

        const opponentVk = document.getElementById("opponentVk").value.trim();
        const betAmount = parseInt(document.getElementById("betAmount").value);
        const user = users[currentUser];

        // –í–∞–ª–∏–¥–∞—Ü–∏—è
        if (!opponentVk) {
            showNotification("–í–≤–µ–¥–∏—Ç–µ —Å—Å—ã–ª–∫—É VK —Å–æ–ø–µ—Ä–Ω–∏–∫–∞", "warning");
            return;
        }

        if (!betAmount || betAmount < 1000000) {
            showNotification("–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–∞–≤–∫–∞: 1.000.000 –≤–∏—Ä—Ç–æ–≤", "warning");
            return;
        }

        if (user.level < 30) {
            showNotification("–î–ª—è –∏–≥—Ä—ã –Ω—É–∂–µ–Ω 30+ —É—Ä–æ–≤–µ–Ω—å", "warning");
            return;
        }

        if (user.virts < betAmount) {
            showNotification("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤–∏—Ä—Ç–æ–≤ –¥–ª—è —Å—Ç–∞–≤–∫–∏", "warning");
            return;
        }

        // –°–æ–∑–¥–∞–µ–º –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ
        const inviteId = 'invite_' + Date.now();
        const invite = {
            id: inviteId,
            from: currentUser,
            fromName: user.username,
            opponentVk: opponentVk,
            betAmount: betAmount,
            status: 'pending',
            createdAt: Date.now()
        };

        activeInvites[inviteId] = invite;
        
        showNotification("–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ! –û–∂–∏–¥–∞–µ–º –æ—Ç–≤–µ—Ç–∞...", "success");
        closeCoinGame();
    }

    function showInvite(invite) {
        currentInvite = invite;
        const inviteInfo = document.getElementById("inviteInfo");
        inviteInfo.innerHTML = `
            <strong>–ò–≥—Ä–æ–∫:</strong> ${invite.fromName}<br>
            <strong>VK:</strong> ${invite.opponentVk}<br>
            <strong>–°—Ç–∞–≤–∫–∞:</strong> ${invite.betAmount.toLocaleString()} –≤–∏—Ä—Ç–æ–≤<br>
            <strong>–ò–≥—Ä–∞:</strong> –û—Ä—ë–ª –∏ –†–µ—à–∫–∞
        `;
        
        let timeLeft = 45;
        document.getElementById("inviteTimer").textContent = timeLeft;
        
        const timer = setInterval(() => {
            timeLeft--;
            document.getElementById("inviteTimer").textContent = timeLeft;
            
            if (timeLeft <= 0) {
                clearInterval(timer);
                rejectInvite();
            }
        }, 1000);
        
        gameTimers.inviteTimer = timer;
        document.getElementById("inviteModal").style.display = "block";
        document.getElementById("profileOverlay").style.display = "block";
    }

    function acceptInvite() {
        if (!currentUser || !currentInvite) return;
        
        const user = users[currentUser];
        if (user.virts < currentInvite.betAmount) {
            showNotification("–£ –≤–∞—Å –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤–∏—Ä—Ç–æ–≤ –¥–ª—è –∏–≥—Ä—ã", "warning");
            rejectInvite();
            return;
        }

        if (user.level < 30) {
            showNotification("–î–ª—è –∏–≥—Ä—ã –Ω—É–∂–µ–Ω 30+ —É—Ä–æ–≤–µ–Ω—å", "warning");
            rejectInvite();
            return;
        }

        clearInterval(gameTimers.inviteTimer);
        document.getElementById("inviteModal").style.display = "none";
        
        // –°–∏–º—É–ª–∏—Ä—É–µ–º –∏–≥—Ä—É
        playCoinGame(currentInvite);
    }

    function rejectInvite() {
        clearInterval(gameTimers.inviteTimer);
        document.getElementById("inviteModal").style.display = "none";
        document.getElementById("profileOverlay").style.display = "none";
        currentInvite = null;
        showNotification("–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–æ", "info");
    }

    function playCoinGame(invite) {
        // –°–∏–º—É–ª—è—Ü–∏—è –∏–≥—Ä—ã
        const result = Math.random() > 0.5 ? '–æ—Ä—ë–ª' : '—Ä–µ—à–∫–∞';
        const user = users[currentUser];
        const opponent = users[invite.from]; // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ —ç—Ç–æ –±—ã–ª –±—ã —Ä–µ–∞–ª—å–Ω—ã–π –æ–ø–ø–æ–Ω–µ–Ω—Ç
        
        let winner = null;
        let winAmount = invite.betAmount * 2;
        
        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
        if (result === '–æ—Ä—ë–ª') {
            winner = currentUser;
            // –ó–∞–±–∏—Ä–∞–µ–º –≤–∏—Ä—Ç—ã —É –ø—Ä–æ–∏–≥—Ä–∞–≤—à–µ–≥–æ –∏ –æ—Ç–¥–∞–µ–º –ø–æ–±–µ–¥–∏—Ç–µ–ª—é
            user.virts += winAmount;
            if (opponent) opponent.virts -= invite.betAmount;
        } else {
            winner = invite.from;
            user.virts -= invite.betAmount;
            if (opponent) opponent.virts += winAmount;
        }
        
        if (winner === currentUser) {
            showGameResult(`üéâ –í—ã –≤—ã–∏–≥—Ä–∞–ª–∏! ${winAmount.toLocaleString()} –≤–∏—Ä—Ç–æ–≤`, result);
        } else {
            showGameResult(`üò¢ –í—ã –ø—Ä–æ–∏–≥—Ä–∞–ª–∏! -${invite.betAmount.toLocaleString()} –≤–∏—Ä—Ç–æ–≤`, result);
        }
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
        users[currentUser] = user;
        if (opponent) users[invite.from] = opponent;
        saveUsers();
        updateStatsUI();
        updateTopPlayer();
    }

    function showGameResult(message, coinSide) {
        const resultElement = document.getElementById("gameResult");
        const coinElement = document.getElementById("coinResult");
        
        resultElement.textContent = message;
        coinElement.textContent = coinSide === '–æ—Ä—ë–ª' ? 'ü¶Ö –û—Ä—ë–ª!' : 'üê¢ –†–µ—à–∫–∞!';
        
        document.getElementById("resultModal").style.display = "block";
        document.getElementById("profileOverlay").style.display = "block";
    }

    function closeResult() {
        document.getElementById("resultModal").style.display = "none";
        document.getElementById("profileOverlay").style.display = "none";
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–ø–∞ –∏–≥—Ä–æ–∫–∞
    function updateTopPlayer() {
        if (!currentUser) return;
        const user = users[currentUser];
        
        const topPlayers = JSON.parse(localStorage.getItem(topKey)) || [];
        const playerIndex = topPlayers.findIndex(p => p.vk === currentUser);
        
        if (playerIndex !== -1) {
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∏–≥—Ä–æ–∫–∞
            topPlayers[playerIndex].virts = user.virts;
            topPlayers[playerIndex].username = user.username;
        } else {
            // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤–æ–≥–æ –∏–≥—Ä–æ–∫–∞
            topPlayers.push({
                username: user.username,
                virts: user.virts,
                vk: currentUser
            });
        }
        
        // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ —É–±—ã–≤–∞–Ω–∏—é –≤–∏—Ä—Ç–æ–≤
        topPlayers.sort((a, b) => b.virts - a.virts);
        
        // –û—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ —Ç–æ–ø-5
        const newTop = topPlayers.slice(0, 5);
        localStorage.setItem(topKey, JSON.stringify(newTop));
        
        updateTopList();
    }

    // –°–∏—Å—Ç–µ–º–∞ –∫–∞–ø—á–∏ - —É–ª—É—á—à–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∞–≤—Ç–æ–∫–ª–∏–∫–µ—Ä–∞
    function checkForAutoClicker() {
        const now = Date.now();
        clickTimes.push(now);
        
        // –û—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –∫–ª–∏–∫–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 —Å–µ–∫—É–Ω–¥
        clickTimes = clickTimes.filter(time => now - time < 5000);
        
        // –ï—Å–ª–∏ –±–æ–ª—å—à–µ 20 –∫–ª–∏–∫–æ–≤ –∑–∞ 5 —Å–µ–∫—É–Ω–¥ - –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–µ –Ω–∞ –∞–≤—Ç–æ–∫–ª–∏–∫–µ—Ä
        if (clickTimes.length > 20 && !captchaRequired) {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–≥—É–ª—è—Ä–Ω–æ—Å—Ç—å –∫–ª–∏–∫–æ–≤ (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ)
            const intervals = [];
            for (let i = 1; i < clickTimes.length; i++) {
                intervals.push(clickTimes[i] - clickTimes[i-1]);
            }
            
            // –í—ã—á–∏—Å–ª—è–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤
            const avg = intervals.reduce((a, b) => a + b, 0) / intervals.length;
            const squareDiffs = intervals.map(value => Math.pow(value - avg, 2));
            const avgSquareDiff = squareDiffs.reduce((a, b) => a + b, 0) / squareDiffs.length;
            const stdDev = Math.sqrt(avgSquareDiff);
            
            // –ï—Å–ª–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–æ–µ (–∫–ª–∏–∫–∏ —Å–ª–∏—à–∫–æ–º —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ) - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–∞–ø—á—É
            if (stdDev < 50 && intervals.length > 10) {
                showCaptcha();
                return true;
            }
        }
        
        return false;
    }

    function generateCaptcha() {
        const chars = "ABCDEFGHJKLMNPQRSTUVWXYZ23456789";
        let captcha = "";
        for (let i = 0; i < 6; i++) {
            captcha += chars.charAt(Math.floor(Math.random() * chars.length));
        }
        return captcha;
    }

    function showCaptcha() {
        captchaRequired = true;
        const captchaText = generateCaptcha();
        document.getElementById('captchaText').textContent = captchaText;
        document.getElementById('captchaInput').value = '';
        document.getElementById('captchaModal').style.display = 'block';
        document.getElementById('profileOverlay').style.display = 'block';
        clickBtn.disabled = true;
    }

    function closeCaptcha() {
        document.getElementById('captchaModal').style.display = 'none';
        document.getElementById('profileOverlay').style.display = 'none';
        captchaRequired = false;
        clickBtn.disabled = false;
        clickTimes = []; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –∫–ª–∏–∫–æ–≤
    }

    function validateCaptcha() {
        const entered = document.getElementById('captchaInput').value.toUpperCase();
        const correct = document.getElementById('captchaText').textContent;
        
        if (entered === correct) {
            closeCaptcha();
            showNotification("–ö–∞–ø—á–∞ –ø—Ä–æ–π–¥–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!", "success");
        } else {
            showNotification("–ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥ –∫–∞–ø—á–∏!", "error");
            document.getElementById('captchaInput').value = '';
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–æ–≤—É—é –∫–∞–ø—á—É
            document.getElementById('captchaText').textContent = generateCaptcha();
        }
    }

    function clickCoin() {
        if (!currentUser) {
            showNotification("–í–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç", "warning");
            return;
        }
        
        if (captchaRequired) {
            showCaptcha();
            return;
        }
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –∞–≤—Ç–æ–∫–ª–∏–∫–µ—Ä
        if (checkForAutoClicker()) {
            return;
        }
        
        const u = users[currentUser];
        if (!u) return;

        if (!sessionStarted) {
            sessionStarted = new Date();
            sessionClicks = 0;
        }
        if (sessionTimer) clearTimeout(sessionTimer);
        sessionTimer = setTimeout(() => {
            endSession();
        }, 5000);

        sessionClicks++;
        clicksThisMinute++;
        const earned = u.power || 1;
        u.coins = (u.coins || 0) + earned;
        u.totalClicks = (u.totalClicks || 0) + 1;
        showCoinAnimation(earned);
        coinsEl.textContent = u.coins;
        totalClicksEl.textContent = u.totalClicks;
        users[currentUser] = u;
        saveUsers();
        checkLevelUp();
    }

    function setupHoverTooltip() {
        const clickBtn = document.getElementById('clickBtn');
        const tooltip = document.getElementById('clickTooltip');
        clickBtn.addEventListener('mouseenter', function (e) {
            if (!currentUser) {
                tooltip.style.display = 'block';
                updateTooltipPosition(e);
            }
        });
        clickBtn.addEventListener('mousemove', function (e) {
            if (!currentUser) {
                updateTooltipPosition(e);
            }
        });
        clickBtn.addEventListener('mouseleave', function () {
            tooltip.style.display = 'none';
        });

        function updateTooltipPosition(e) {
            const x = e.clientX + 15;
            const y = e.clientY + 15;
            tooltip.style.left = x + 'px';
            tooltip.style.top = y + 'px';
        }
    }

    function toggleHelp() {
        const helpModal = document.getElementById('helpModal');
        const helpOverlay = document.getElementById('helpOverlay');
        if (helpModal.style.display === 'block') {
            helpModal.style.display = 'none';
            helpOverlay.style.display = 'none';
        } else {
            helpModal.style.display = 'block';
            helpOverlay.style.display = 'block';
        }
    }

    function toggleTop() {
        if (!currentUser) {
            showNotification("–í–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç —á—Ç–æ–±—ã –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–æ–ø", "warning");
            return;
        }
        topBoxEl.style.display = topBoxEl.style.display === 'block' ? 'none' : 'block';
    }

    function getUpgradeCost(upgradeId) {
        if (!currentUser) return BASE_UPGRADE_COSTS[upgradeId];
        const user = users[currentUser];
        const level = user.level || 1;
        return Math.floor(BASE_UPGRADE_COSTS[upgradeId] * Math.pow(1.14, level - 1));
    }

    function updateShopPrices() {
        if (!currentUser) return;
        const user = users[currentUser];
        const level = user.level || 1;
        document.getElementById('upgrade1Cost').textContent = getUpgradeCost(1);
        document.getElementById('upgrade2Cost').textContent = getUpgradeCost(2);
        document.getElementById('upgrade3Cost').textContent = getUpgradeCost(3);
    }

    function getClicksForNextLevel(currentLevel) {
        return Math.floor(1000 * Math.pow(1.22, currentLevel - 1));
    }

    function checkLevelUp() {
        if (!currentUser) return;
        const user = users[currentUser];
        const currentLevel = user.level || 1;
        const totalClicks = user.totalClicks || 0;
        if (currentLevel >= 999) return;
        const clicksNeeded = getClicksForNextLevel(currentLevel);
        if (totalClicks >= clicksNeeded) {
            user.level = currentLevel + 1;
            users[currentUser] = user;
            saveUsers();
            showNotification(`üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –¥–æ—Å—Ç–∏–≥–ª–∏ ${user.level} —É—Ä–æ–≤–Ω—è!`, "success");
            updateShopPrices();
        }
    }

function getLevelProgress() {
    if (!currentUser) return {percentage: 0, current: 0, needed: 0};
    const user = users[currentUser];
    const currentLevel = user.level || 1;
    const totalClicks = user.totalClicks || 0;
    
    if (currentLevel >= 999) return {percentage: 100, current: 0, needed: 0};
    
    const prevLevelClicks = currentLevel === 1 ? 0 : getClicksForNextLevel(currentLevel - 1);
    const nextLevelClicks = getClicksForNextLevel(currentLevel);
    const currentLevelClicks = totalClicks - prevLevelClicks;
    const clicksNeeded = nextLevelClicks - prevLevelClicks;
    
    // –î–æ–±–∞–≤–ª—è–µ–º –∑–∞—â–∏—Ç—É –æ—Ç –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –∏ –¥–µ–ª–µ–Ω–∏—è –Ω–∞ –Ω–æ–ª—å
    const percentage = clicksNeeded > 0 
        ? Math.max(0, Math.min(100, Math.floor((currentLevelClicks / clicksNeeded) * 100)))
        : 100;
    
    return {percentage, current: currentLevelClicks, needed: clicksNeeded};
}

    function showProfile() {
        if (!currentUser) {
            showNotification("–í–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç —á—Ç–æ–±—ã –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø—Ä–æ—Ñ–∏–ª—å", "warning");
            return;
        }
        const user = users[currentUser];
        document.getElementById('profileUsername').textContent = user.username || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ';
        document.getElementById('profileLevel').textContent = user.level || 1;
        const progress = getLevelProgress();
        document.getElementById('levelProgress').textContent = `${progress.percentage}%`;
        document.getElementById('levelProgressBar').style.width = `${progress.percentage}%`;
        document.getElementById('profileWithdraws').textContent = user.withdrawCount || 0;
        document.getElementById('profileCreated').textContent = user.createdDate || '15.12.2023';
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É Admin Panel —Ç–æ–ª—å–∫–æ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        if (currentUser === 'diego_retroware') {
            document.getElementById('adminPanelBtn').style.display = 'block';
        } else {
            document.getElementById('adminPanelBtn').style.display = 'none';
        }
        
        document.getElementById('profileModal').style.display = 'block';
        document.getElementById('profileOverlay').style.display = 'block';
    }

    function hideProfile() {
        document.getElementById('profileModal').style.display = 'none';
        document.getElementById('profileOverlay').style.display = 'none';
    }

    function openAdminPanel() {
        window.open('https://by-retroware.github.io/Firebase/', '_blank');
    }

    for (let i = 0; i < 60; i++) {
        let d = document.createElement("div");
        d.className = "raindrop";
        d.style.left = Math.random() * 100 + "vw";
        d.style.animationDuration = (Math.random() * 1 + 0.8) + "s";
        d.style.opacity = (Math.random() * 0.6 + 0.15).toString();
        d.style.height = (12 + Math.random() * 18) + "px";
        document.body.appendChild(d);
    }

    !function init() {
        const rem = localStorage.getItem(rememberKey);
        if (rem && users[rem]) {
            currentUser = rem;
            loadUserData();
            enableClick(true);
            startAutoClicker();
            updateAuthUI();
        }
        updateStatsUI();
        cpmInterval = setInterval(() => {
            clicksThisMinute = 0;
        }, 60000);
        setupHoverTooltip();
        initTopPlayers();
    }();

    function updateAuthUI() {
        if (currentUser) {
            loginIcon.style.display = 'none';
            profileBtn.style.display = 'block';
        } else {
            loginIcon.style.display = 'block';
            profileBtn.style.display = 'none';
        }
    }

    function saveUsers() {
        localStorage.setItem(usersKey, JSON.stringify(users));
    }

    function openLogin() {
        if (currentUser) {
            showNotification("–í—ã —É–∂–µ –≤–æ—à–ª–∏ –≤ –∞–∫–∫–∞—É–Ω—Ç", "warning");
            return;
        }
        document.getElementById("loginModal").style.display = "flex";
        document.getElementById("registerModal").style.display = "none";
        clearErrors();
    }

    function openRegister() {
        if (currentUser) {
            showNotification("–°–Ω–∞—á–∞–ª–∞ –≤—ã–π–¥–∏—Ç–µ –∏–∑ —Ç–µ–∫—É—â–µ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞", "warning");
            return;
        }
        document.getElementById("registerModal").style.display = "flex";
        document.getElementById("loginModal").style.display = "none";
        clearErrors();
    }

    function closeModals() {
        document.getElementById("loginModal").style.display = "none";
        document.getElementById("registerModal").style.display = "none";
    }

    function togglePassword(id) {
        const el = document.getElementById(id);
        el && (el.type = el.type === "password" ? "text" : "password");
    }

    function clearErrors() {
        document.querySelectorAll('.error').forEach(el => el.style.display = 'none');
        document.querySelectorAll('input').forEach(el => el.classList.remove('input-error'));
    }

    function showError(id, message) {
        const errorEl = document.getElementById(id);
        if (errorEl) {
            errorEl.textContent = message;
            errorEl.style.display = 'block';
        }
        document.querySelector(`#${id.replace('Error', '')}`).classList.add('input-error');
    }

    function doRegister() {
        clearErrors();
        const username = document.getElementById("regName").value.trim(),
            vk = normalizeVk(document.getElementById("regVk").value.trim()),
            pass = document.getElementById("regPass").value,
            confirm = document.getElementById("regConfirm").value;
        let hasError = false;
        if (!username) {
            showError("regNameError", "–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è");
            hasError = true;
        }
        if (!vk || !isValidVk(vk)) {
            showError("regVkError", "–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π VK ID");
            hasError = true;
        }
        if (!pass || pass.length < 4) {
            showError("regPassError", "–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 4 —Å–∏–º–≤–æ–ª–∞");
            hasError = true;
        }
        if (pass !== confirm) {
            showError("regConfirmError", "–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç");
            hasError = true;
        }
        if (users[vk]) {
            showError("regVkError", "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º VK ID —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç");
            hasError = true;
        }
        if (hasError) return;
        users[vk] = {
            username: username,
            password: pass,
            coins: 1000000, // –ù–∞—á–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            virts: 10000,   // –ù–∞—á–∞–ª—å–Ω—ã–µ –≤–∏—Ä—Ç—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            power: 1,
            totalClicks: 0,
            level: 35,      // –£—Ä–æ–≤–µ–Ω—å –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏–≥—Ä—ã
            upgrades: {click: 1, autoclick: 0},
            sessions: [],
            withdrawCount: 0,
            createdDate: new Date().toLocaleDateString()
        };
        saveUsers();
        currentUser = vk;
        loadUserData();
        enableClick(true);
        closeModals();
        showNotification("–ê–∫–∫–∞—É–Ω—Ç —Å–æ–∑–¥–∞–Ω –∏ –≤—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–æ—à–ª–∏ –≤ —Å–∏—Å—Ç–µ–º—É. –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, " + username + "!", "success");
        if (document.getElementById("rememberMe").checked) {
            localStorage.setItem(rememberKey, vk);
        }
        updateTopPlayer();
        updateAuthUI();
    }

    function doLogin() {
        clearErrors();
        const vk = normalizeVk(document.getElementById("loginVk").value.trim()),
            pass = document.getElementById("loginPass").value,
            remember = document.getElementById("rememberMe").checked;
        let hasError = false;
        if (!vk || !isValidVk(vk)) {
            showError("loginVkError", "–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π VK ID");
            hasError = true;
        }
        if (!pass) {
            showError("loginPassError", "–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å");
            hasError = true;
        }
        if (hasError) return;
        if (!users[vk] || users[vk].password !== pass) {
            showError("loginPassError", "–ù–µ–≤–µ—Ä–Ω—ã–π VK ID –∏–ª–∏ –ø–∞—Ä–æ–ª—å");
            hasError = true;
            return;
        }
        currentUser = vk;
        loadUserData();
        enableClick(true);
        closeModals();
        startAutoClicker();
        remember ? localStorage.setItem(rememberKey, vk) : localStorage.removeItem(rememberKey);
        showNotification("–í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω. –ü—Ä–∏–≤–µ—Ç, " + users[vk].username + "!", "success");
        updateTopPlayer();
        updateAuthUI();
    }

    function isValidVk(vk) {
        return vk.length > 0 && /^[a-zA-Z0-9_.]+$/.test(vk);
    }

    function logout() {
        if (!currentUser) {
            showNotification("–í—ã –Ω–µ –≤–æ—à–ª–∏", "warning");
            return;
        }
        if (sessionStarted) endSession();
        stopAutoClicker();
        saveUserData();
        currentUser = null;
        enableClick(false);
        localStorage.removeItem(rememberKey);
        shopEl.style.display = "none";
        withdrawBoxEl.style.display = "none";
        topBoxEl.style.display = "none";
        hideProfile();
        showNotification("–í—ã –≤—ã—à–ª–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞.", "info");
        updateAuthUI();
    }

    function normalizeVk(input) {
        if (!input) return "";
        try {
            const url = new URL(input);
            if (url.hostname.includes("vk.com")) return url.pathname.replace(/^\/+/, "");
        } catch (e) {
        }
        return input;
    }

    function saveUserData() {
        if (!currentUser) return;
        const u = users[currentUser];
        if (!u) return;
        u.coins = parseInt(coinsEl.textContent) || u.coins || 0;
        u.virts = parseInt(virtsEl.textContent) || u.virts || 0;
        u.power = parseInt(powerEl.textContent) || u.power || 1;
        u.totalClicks = parseInt(totalClicksEl.textContent) || u.totalClicks || 0;
        users[currentUser] = u;
        saveUsers();
        updateTopPlayer();
    }

    function loadUserData() {
        if (!currentUser) return;
        const u = users[currentUser];
        if (!u) return;
        coinsEl.textContent = u.coins || 0;
        virtsEl.textContent = u.virts || 0;
        powerEl.textContent = u.power || 1;
        totalClicksEl.textContent = u.totalClicks || 0;
        if (!u.upgrades) u.upgrades = {click: 1, autoclick: 0};
        if (!u.level) u.level = 1;
        updateShopPrices();
    }

    function enableClick(on) {
        clickBtn.disabled = !on;
    }

    function showCoinAnimation(amount) {
        const animation = document.createElement('div');
        animation.className = 'coin-animation';
        animation.textContent = `+${amount} üíé`;
        animation.style.left = `${Math.random() * 80 + 10}%`;
        document.querySelector('.clicker-area').appendChild(animation);
        setTimeout(() => {
            animation.remove();
        }, 1500);
    }

    function endSession() {
        if (!currentUser || !sessionStarted) {
            sessionStarted = null;
            sessionClicks = 0;
            return;
        }
        const start = sessionStarted, end = new Date(), clicks = sessionClicks;
        const u = users[currentUser];
        u.sessions = u.sessions || [];
        u.sessions.push({startISO: start.toISOString(), endISO: end.toISOString(), clicks: clicks});
        users[currentUser] = u;
        saveUsers();
        if (logBox.style.display === "block") renderLog();
        sessionStarted = null;
        sessionClicks = 0;
        if (sessionTimer) {
            clearTimeout(sessionTimer);
            sessionTimer = null;
        }
    }

    function toggleShop() {
        if (!currentUser) {
            showNotification("–ù—É–∂–Ω–æ –≤–æ–π—Ç–∏ –≤ –∞–∫–∫–∞—É–Ω—Ç, —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å –º–∞–≥–∞–∑–∏–Ω.", "warning");
            return;
        }
        shopEl.style.display === "grid" ? shopEl.style.display = "none" : (shopEl.style.display = "grid", withdrawBoxEl.style.display = "none", topBoxEl.style.display = "none");
    }

    function buyUpgrade(type, cost, value) {
        if (!currentUser) return;
        const u = users[currentUser];
        if (u.coins < cost) {
            showNotification("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç –¥–ª—è –ø–æ–∫—É–ø–∫–∏!", "warning");
            return;
        }
        u.coins -= cost;
        switch (type) {
            case 'click':
                u.power += value;
                powerEl.textContent = u.power;
                showNotification(`–£–ª—É—á—à–µ–Ω–∏–µ –∫—É–ø–ª–µ–Ω–æ! –¢–µ–ø–µ—Ä—å —Å–∏–ª–∞ –∫–ª–∏–∫–∞: ${u.power}`, "success");
                break;
            case 'autoclick':
                u.upgrades.autoclick += value;
                startAutoClicker();
                showNotification("–ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä –∫—É–ø–ª–µ–Ω! –¢–µ–ø–µ—Ä—å –≤—ã –±—É–¥–µ—Ç–µ –ø–æ–ª—É—á–∞—Ç—å –º–æ–Ω–µ—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.", "success");
                break;
        }
        coinsEl.textContent = u.coins;
        users[currentUser] = u;
        saveUsers();
    }

    function startAutoClicker() {
        if (!currentUser) return;
        const u = users[currentUser];
        if (u.upgrades.autoclick > 0) {
            stopAutoClicker();
            autoClickInterval = setInterval(() => {
                if (currentUser) {
                    const earned = u.power || 1;
                    u.coins += earned;
                    coinsEl.textContent = u.coins;
                    const autoClickNotice = document.createElement('div');
                    autoClickNotice.textContent = `–ê–≤—Ç–æ–∫–ª–∏–∫: +${earned} üíé`;
                    autoClickNotice.style.position = 'fixed';
                    autoClickNotice.style.bottom = '10px';
                    autoClickNotice.style.right = '10px';
                    autoClickNotice.style.background = 'rgba(0,0,0,0.7)';
                    autoClickNotice.style.color = '#77ff00';
                    autoClickNotice.style.padding = '5px 10px';
                    autoClickNotice.style.borderRadius = '5px';
                    autoClickNotice.style.fontSize = '10px';
                    autoClickNotice.style.zIndex = '1000';
                    document.body.appendChild(autoClickNotice);
                    setTimeout(() => {
                        autoClickNotice.remove();
                    }, 2000);
                    users[currentUser] = u;
                    saveUsers();
                }
            }, 5000);
        }
    }

    function stopAutoClicker() {
        if (autoClickInterval) {
            clearInterval(autoClickInterval);
            autoClickInterval = null;
        }
    }

    function toggleWithdraw() {
        if (!currentUser) {
            showNotification("–ù—É–∂–Ω–æ –≤–æ–π—Ç–∏ –≤ –∞–∫–∫–∞—É–Ω—Ç, —á—Ç–æ–±—ã –∑–∞–ø—Ä–æ—Å–∏—Ç—å –≤—ã–≤–æ–¥.", "warning");
            return;
        }
        withdrawBoxEl.style.display === "block" ? withdrawBoxEl.style.display = "none" : (withdrawBoxEl.style.display = "block", shopEl.style.display = "none", topBoxEl.style.display = "none");
    }

    function requestWithdraw() {
        const nickname = document.getElementById("nickname").value.trim(),
            amount = parseInt(document.getElementById("withdrawAmount").value),
            u = users[currentUser];
        if (!nickname) {
            showNotification("–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –∏–≥—Ä–æ–≤–æ–π –Ω–∏–∫–Ω–µ–π–º", "warning");
            return;
        }
        if (!amount || amount < 3000) {
            showNotification("–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –¥–ª—è –≤—ã–≤–æ–¥–∞: 3000 –≤–∏—Ä—Ç–æ–≤", "warning");
            return;
        }
        if (u.virts < amount) {
            showNotification("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤–∏—Ä—Ç–æ–≤ –¥–ª—è –≤—ã–≤–æ–¥–∞", "warning");
            return;
        }
        
        // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤–∏—Ä—Ç—ã –≤ –º–æ–Ω–µ—Ç—ã (1 –≤–∏—Ä—Ç = 100 –º–æ–Ω–µ—Ç)
        const coinsToAdd = amount * 100;
        u.coins += coinsToAdd;
        u.virts -= amount;
        u.withdrawCount = (u.withdrawCount || 0) + 1;
        
        coinsEl.textContent = u.coins;
        virtsEl.textContent = u.virts;
        
        showNotification(`–ó–∞–ø—Ä–æ—Å –Ω–∞ –≤—ã–≤–æ–¥ ${amount} –≤–∏—Ä—Ç–æ–≤ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω! –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ –≤ ${coinsToAdd.toLocaleString()} –º–æ–Ω–µ—Ç. –°—Ä–µ–¥—Å—Ç–≤–∞ –±—É–¥—É—Ç –∑–∞—á–∏—Å–ª–µ–Ω—ã –≤ —Ç–µ—á–µ–Ω–∏–µ 24 —á–∞—Å–æ–≤.`, "success");
        users[currentUser] = u;
        saveUsers();
        document.getElementById("nickname").value = "";
        document.getElementById("withdrawAmount").value = "";
        withdrawBoxEl.style.display = "none";
        updateTopPlayer();
    }

    function toggleLog() {
        if (!currentUser) {
            showNotification("–ù—É–∂–Ω–æ –≤–æ–π—Ç–∏ –≤ –∞–∫–∫–∞—É–Ω—Ç, —á—Ç–æ–±—ã –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–µ—Å—Å–∏–∏.", "warning");
            return;
        }
        logBox.style.display === "block" ? logBox.style.display = "none" : (renderLog(), logBox.style.display = "block");
    }

    function renderLog() {
        const u = users[currentUser];
        if (!u) return;
        let html = `<div style="font-weight:bold;margin-bottom:6px;color:var(--neon)">–°–µ—Å—Å–∏–∏ ‚Äî ${u.username}</div>`;
        if (!u.sessions || u.sessions.length === 0) html += `<div class="log-entry">–°–µ—Å—Å–∏–π –µ—â—ë –Ω–µ—Ç.</div>`;
        else {
            const arr = u.sessions.slice().reverse();
            arr.forEach(s => {
                const st = new Date(s.startISO), en = new Date(s.endISO), stStr = st.toLocaleString(), enStr = en.toLocaleString();
                html += `<div class="log-entry"><b>–ù–∞—á–∞–ª:</b> ${stStr}<br><b>–ó–∞–∫–æ–Ω—á–∏–ª:</b> ${enStr} <span style="float:right">(<b>–Ω–∞–∫–ª–∏–∫–∞–ª:</b> ${s.clicks})</span></div>`;
            });
        }
        html += `<div style="margin-top:8px;color:var(--neon-soft)"><b>–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∏–∫–æ–≤:</b> ${u.totalClicks || 0}</div>`;
        logBox.innerHTML = html;
    }

    function showNotification(message, type = "info") {
        const notification = document.createElement('div');
        notification.className = 'notification';
        notification.textContent = message;
        if (type === "success") {
            notification.style.borderColor = "var(--success)";
            notification.style.color = "var(--success)";
        } else if (type === "warning") {
            notification.style.borderColor = "var(--warning)";
            notification.style.color = "var(--warning)";
        } else if (type === "error") {
            notification.style.borderColor = "var(--error)";
            notification.style.color = "var(--error)";
        }
        document.body.appendChild(notification);
        setTimeout(() => {
            notification.remove();
        }, 3000);
    }

    function updateStatsUI() {
        coinsEl.textContent = coinsEl.textContent || "0";
        virtsEl.textContent = virtsEl.textContent || "0";
        powerEl.textContent = powerEl.textContent || "1";
        totalClicksEl.textContent = totalClicksEl.textContent || "0";
    }

    window.addEventListener("beforeunload", () => {
        if (sessionStarted) endSession();
        stopAutoClicker();
        saveUserData();
    });

    function toggleInfo() {
        infoBox.style.display = infoBox.style.display === "block" ? "none" : "block";
    }

    document.getElementById("loginVk").addEventListener("focus", () => {
    });
    document.getElementById("regVk").addEventListener("focus", () => {
    });

    window._hype = {users, saveUsers};
</script>
</body>
</html>